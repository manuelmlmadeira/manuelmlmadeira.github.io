<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="-mRHvwnHdFYIa-KaKIgZIGLfsdeDLGZ9rZEsWECSiuE"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Heat #1 - The Heat Equation | Manuel Madeira</title> <meta name="author" content="Manuel Madeira"> <meta name="description" content="First blogpost of a series on the Heat equation, where we introduce the Heat partial differential equation."> <meta name="keywords" content="Manuel, Madeira, personal, web, site, page, machine learning, artificial intelligence"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%92%A1&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://manuelmlmadeira.github.io/blog/2022/heat-1-heat-equation/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">ManuelÂ <span class="font-weight-bold">Madeira</span></a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Heat #1 - The Heat Equation</h1> <p class="post-meta">February 14, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a> </p> </header> <article class="post-content"> <p><strong>Authors</strong>: Manuel Madeira, David Carvalho</p> <p><strong>Reviewers</strong>: FÃ¡bio Cruz</p> <p><em>This blog post was developed while working at <a href="https://inductiva.ai/" rel="external nofollow noopener" target="_blank">Inductiva Research Labs</a>.</em></p> <hr> <p>The world of classical simulation and the world AI are merging into a broader form of computational solutions for science and engineering. In this tutorial, we will guide you through an example one of the most exciting technical outcomes of this marriage between classical simulation and AI: Physics-Informed Neural Networks, or PINNs for short. The most notable difference between using PINNs vs using more generic neural networks is that, in PINNs, we explicitly encode knowledge about the the physical laws in the training loss of the neural network, allowing it to more quickly converge to functions that are physically sound.</p> <p>As a simple example, we will focus on the problem of ðŸ”¥ <strong>heat diffusion</strong> on a plate! ðŸ”¥</p> <p>We will take you step by step up to a point where you can gauge the potential of Neural Networks in solving Partial Differential Equations:</p> <ol> <li> <p><strong>The Heat Equation</strong>: introduces the physics behind heat diffusion.</p> </li> <li> <p><strong>Finite-Differences</strong>: classical numerical routine to approximate its solution across a 2D plate.</p> </li> <li> <p><strong>Physics-Informed Neural Network</strong>: with that estimate of the solution as a <em>benchmark</em>, see how <strong>Machine-Learning algorithms</strong> fare for the same situation, by deploying a PINN (Physics-Informed Neural Network).</p> </li> <li> <p><strong>Generalized Neuro-Solver*</strong>: explore further into how versatile these Neural Networks are in handling <strong>more complex geometries</strong> than the 2D domain and <strong>varying initial/boundary conditions</strong>;</p> </li> </ol> <p>This field is fast-growing but, most importantly is at its <em>blissful infancy</em> stage. Our dream, rooted in a belief, is that Machine Learning may be refined to excel in extremely complex and customizable cases.</p> <p>This sophistication could potentially fare better in performance than every other classical solver, allowing us to go to lands classical frameworks have never granted us so far!</p> <p>Alright. ðŸ”¥ <em>Letâ€™s get hot in here!</em> ðŸ”¥</p> <h2 id="the-heat-equation-a-warm-up">The Heat Equation: a warm-up</h2> <p>Everybody has an elementary feeling for what heat is. <em>Heat diffusion</em> is the process through which energy is transported in space due to gradients in temperature.</p> <p>These considerations are reflected mathematically in the so-called <em>Heat Equation</em>, which sets how the temperature $u(t, \mathbf{r})$ at a point in space $\mathbf{r}$ and time instant $t$ evolves. It must satisfy:</p> \[\begin{equation} \frac{\partial u (t, \mathbf{r})}{\partial t} - D \Delta u(t, \mathbf{r}) = 0. \end{equation}\] <p>The thermal diffusivity $D$ controls how fast heat can spread around a neighborhood. For more realistic (and oftentimes less structured) media, their specifics result in a <em>local</em> diffusity $D(t, \mathbf{r})$. In the <em>Heat</em> series, we consider homogeneous media, for which $D$ is constant throughout.</p> <p>Now, what about $\Delta$ â€” the <em>Laplacian</em> operator? Letâ€™s see how it acts on a function $u$:</p> \[\Delta u = \nabla \cdot (\nabla u) = \sum_{i} \frac{\partial^2 u}{\partial {r_i}^2}\] <p>So we have $n$ $2^\rm{nd}$-order partial spatial derivatives to account for but also a single $1^\rm{st}$-order partial derivative in time. Thatâ€™s a large batch of <strong>differential operators</strong> right there. We can lump them into a single <em>differential operator</em> which governs the evolution of the solution weâ€™re after:</p> \[\mathcal{L} \left[ \frac{\partial}{\partial t}, \frac{\partial^2}{\partial^2_{r_1}}, \dots \frac{\partial^2}{\partial^2_{r_n}} \right] u(t, \mathbf{r}) = 0\] <p>Alright â€” no doubt weâ€™re in the presence of a <strong>Partial Differential Equation</strong>.</p> <p><em>These beasts are not easy to tame</em>. However, throughout the <em>Heat</em> series, we exploit the structural simplicity of the Heat Equation â€” alongside the fact it is both very intuitive to understand and easy to set up meaningfully.</p> <h3 id="heating-across-a-2d-square-plate">Heating across a 2D square plate</h3> <p>Weâ€™ll guide you on how to solve this equation in a simple yet realistic geometric setup: across a <em>2-dimensional plate</em> of variable size [2].</p> <p>As you will soon see, this domain is simple enough not only to allow intuitive visualization but also to provide the possibility of adding extra complexity without much effort.</p> <p>So letâ€™s have a go. Our spatial vector in 2 dimensions is $\mathbf{r} = (x, y)$ and so the heat equation takes the form:</p> \[\left[ \frac{\partial}{\partial t} - D \left( \frac{\partial^2}{\partial x ^2} + \frac{\partial^2}{\partial y ^2} \right) \right]u(t,x,y)= 0\] <p>From a computational point of view, it will do us a favor to think in terms of the result upon applying each differential operator to the solution:</p> \[\begin{equation} u_t - D \left( u_{xx} + u_{yy} \right) = 0 \label{HE_2D} \end{equation}\] <p>where the partial derivatives are shorthanded to, say, $\partial_{x} \equiv \partial / \partial x$ and $\partial_{xx} = \partial_{x} \partial_{x}$.</p> <p>But hold on! We canâ€™t start solving this beast just yetâ€¦</p> <h3 id="setting-boundary-and-initial-conditions">Setting boundary and initial conditions</h3> <p>We need more information to formulate completely this PDE. <strong>Initial and boundary conditions</strong> ensure that a <em>unique</em> solution exists by the function at particular points $(t,x,y)$ of the input space.</p> <p>These are normally reasoned through intuition and hindsight. Throughout the <em>Heat</em> series, we employ <em>Dirichlet boundary conditions</em>, which ensure:</p> <ul> <li> <p>through the <em>initial condition</em>, that a certain temperature is fixed across <em>all</em> points on the plate at the initial time instant (when $t=0$). Weâ€™ll take $ u(0, x, y) = -1 ^\mathrm{o}C $.</p> </li> <li> <p>through the the <em>boundary conditions</em>, that a temperature is fixed at <em>all</em> times <em>only</em> for points along the 4 edges of the plate (top, bottom, left and right). We choose the energy source to act as to get the top edge to some hot temperature. Weâ€™ll take $u(t, x, y_{\max}) = 1^\circ C.$ The remaining edges are held at some cold temperature. Weâ€™ll take: \(\underbrace{u(t, x, y_{\min})}_{\text{Bottom}} = \underbrace{u(t, x_{\min}, y)}_{\text{Left}} = \underbrace{u(t, x_{\max}, y)}_{\text{Right}} = -1^\circ C.\)</p> </li> </ul> <div style="text-align: center;"> <img style="width:40%;" src="../../../assets/img/blogposts/heat1/BIC.png"> </div> <p><strong>Fig. 1</strong>: The boundary and initial conditions used throughout the Heat series. Energy is pumped from the top edge onto an initially completely cold 2D plate. Credits: David Carvalho / Inductiva.</p> <h3 id="classical-numerical-methods">Classical Numerical Methods</h3> <p>As usual, finding governing equations from first principles is actually the easy part. Rather, solving them presents us major challenges. Why?</p> <p><strong>Most PDEs do not admit analytical, pen-and-paper solutions.</strong> Only a handful of cherry-picked differential operators can give rise to closed-form solutions. <em>Lesson learnt</em> â€” <strong>numerical approximations</strong> must be used.</p> <blockquote> <p>But which ones? In which conditions? For what type of PDE?</p> </blockquote> <p>These are general and difficult questions to answer. Wildly different methods have been curated by the computationally-inclined in the Mathematical and Physical communities â€” not as recipes set on stone but rather frameworks prone to constant scrutiny.</p> <p><em>Mesh-based methods</em> are traditionally the dominant approaches. The main idea is to <strong>discretize</strong> the domain of interest into a set of mesh points and, with them, approximate the solution. A whole zoo of methods exists, in particular:</p> <ul> <li> <strong>Finite Differences Methods (FDMs)</strong> replace the PDE expression with a discretized analogue along a grid with the aid of <em>function differences</em>.</li> <li> <strong>Finite Elements Methods (FEMs)</strong> subdivide the problem domain in multiple elements and apply the equations to each one of them.</li> <li> <strong>Finite Volume Methods (FVMs)</strong> builds a solution approximation based on the exact computation (taking advantage of the divergence theorem) of the average value of the solution function in each of the smaller sub-volumes in which the domain is partitioned.</li> </ul> <p>All these methods have their advantages and shortcomings given the idiosyncrasies of each PDE and setup of the problem. Sometimes they may even coincide â€” for some simple scenarios (such as regular grids) FEMs and FDMs <em>might</em> end up being the same [1].</p> <p>Typically, mesh-based classical routines tend to be very efficient in low-dimensional problems on regular geometries. We will then use this convenience to our advantage by applying <strong>a FDM in a FTCS (Forward in Time, Centered in Space) scheme.</strong></p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> Â© Copyright 2025 Manuel Madeira. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["\\[","\\]"]],tags:"ams"},svg:{fontCache:"global"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-6BNW5R0VXG"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6BNW5R0VXG");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>